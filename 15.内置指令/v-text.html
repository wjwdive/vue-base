<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>过滤器</title>

    <script src="js/vue.js"></script>
    <script src="js/day.js"></script>

    <!-- <script src="https://cdn.bootcdn.net/ajax/libs/dayjs/1.11.3/dayjs.min.js"></script>
    https://cdn.bootcdn.net/ajax/libs/dayjs/1.11.3/locale/af.js -->
    <!--bootCDN.cn里面有好多好用的第三方js库 moment.js, day.js -->
</head>
<body>
    <!-- 

     -->
    <div id="root">
<!-- 
    过滤器：
    定义：对要显示的数据进行特定格式化后再显示，适用于简单逻辑
    语法：
        1。注册过滤器: Vue.filter(name, callback) 或 new Vue(filters:{})
        2.使用过滤器{{ xxx | filterName }} 或 v-bind: 属性="xxx | 过滤器名"
    备注：
        1.过滤器也可以接收额外参数、多个过滤器也可以串联
        2.并没有改变元数据，而是计算产生了新的数据
 -->

        <h2>显示格式化后的时间</h2>
        <!-- 计算属性实现 -->
        <h3>现在时间：{{formatTime}}</h3>
        <!-- methods实现 -->
        <h3>现在是：{{getFormatTime()}}</h3>
        <!-- 过滤器实现 -->
        <h3>现在是： {{ time | timeFormatter }}</h3>
        <!-- 过滤器传参实现 -->
        <h3>现在是： {{ time | timeFormatterParam('YYYY-MM-DD') }}</h3>
        <!-- 过滤器串联使用 -->
        <h3>现在是： {{ time | timeFormatterParam('YYYY-MM-DD') | sliceFirst4 }}</h3>

        <!-- 过滤器不只能用到差值语法里，还能用到 v-bind: 所绑定的属性里,在元素里查看，msgssage，会只有mess-->
        <h3 :x="msg | first4 ">v-bind:x="message" 经过过滤器，变成了 v-bind:x="mess"</h3>

        <p>使用，如果电商网站，9999,变为9,999 就可以使用过滤器</p>
    </div>

    <script type="text/javascript">
        Vue.config.productionTip = false
        Vue.filter('first4', function(value) {
            return value.slice(0, 4)
        })

        const vm = new Vue({
            el: "#root",
            data: {
                time: 1657034001348,
                msg: 'message'
            },
            methods: {
                getFormatTime() {
                    return dayjs(this.time,).format('YYYY-MM-DD HH:mm:ss')
                }
            },
            computed: {
                formatTime() {
                    return dayjs(this.time,).format('YYYY-MM-DD HH:mm:ss')
                }
            },
            // 过滤器的本质就是一个函数，把管道符 | 之前的值作为参数，经过函数处理，
            // 把返回值赋值给管道符后，可以连着用，以最后管道符计算结果为准
            //Vue里写的过滤器都是局部过滤器, 组件里也是如此，如果要定义全局组件，需要在 Vue实例创建之前实现
            filters: {
                timeFormatter() {
                    return dayjs(this.time,).format('YYYY-MM-DD HH:mm:ss')
                },
                timeFormatterParam(value, str='YYYY-MM-DD HH:mm:ss') {
                    return dayjs(value).format(str)
                },
                sliceFirst4(value) {
                    return value.slice(0, 4)
                }
            }
        })
    </script>

</body>
</html>